<div class="modal-content">
  <div class="modal-header">
    <h5 class="modal-title">Import Data</h5>
    <button
      type="button"
      class="close"
      data-dismiss="modal"
      aria-label="Close"
      (click)="close()"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group">
      <span class="d-flex justify-content-between">
        <label for="file">Upload File</label>
        <a href="/assets/sample-format-import.xlsx">Download format xls</a>
      </span>
      <input
        type="file"
        class="form-control"
        (change)="onChange($event)"
        #inputFile
      />
    </div>

    <div class="mb-2">
      <button class="btn btn-info mr-3" (click)="generate()">generate</button>

      <button (click)="import()" class="btn btn-warning">Import</button>
    </div>

    <div *ngIf="isExcelFile === false">This is not an Excel file</div>
    <span *ngIf="spinnerEnabled" class="k-i-loading k-icon"></span>
    <div class="table-responsive">
      <table class="table table-bordered">
        <th *ngFor="let key of keys">
          {{ key }}
        </th>
        <tr *ngFor="let item of dataSheet">
          <td *ngFor="let key of keys">
            {{ item[key] }}
          </td>
        </tr>
      </table>
    </div>
  </div>
  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-secondary"
      data-dismiss="modal"
      (click)="close()"
    >
      Batal
    </button>
    <button
      type="button"
      class="btn btn-primary"
      [disabled]="!dataSheet"
      (click)="save()"
    >
      Import Data
    </button>
  </div>
</div>

<ng-container *ngIf="spinnerEnabled">
  <div class="spinner-wrapper">
    <div class="spinner-border" role="status">
      <span class="sr-only">Loading...</span>
    </div>
  </div>
</ng-container>
